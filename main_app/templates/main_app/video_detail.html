{% extends 'base.html' %}
{% block content %}
{% load static %}

<div>

<div class="container">
    <div class="row">
        <div class="col-6">
            <video autoplay="autoplay" controls="controls" preload="preload" style="height: 33rem; width: 50rem; background-color: black; margin-top: 3rem;">
                <source src={% static video.video|cut:'main_app/static/' %} type="video/mp4">
            </video>
            <h1>{{ video.title }}</h1>
            <p>{{ video.description }}</p>
            <div class="card-action">
                <a href="{% url 'videos_update' video.id %}">EDIT</a>
                <a href="{% url 'videos_delete' video.id %}">DELETE</a>
            </div>
            <div class="col-3" >
                {% if user.is_authenticated %}
                {% csrf_token %}
                <button id="subscribe_button" class="{% if is_subscribed %}btn btn-outline-light{% else %}btn btn-light{% endif %}" onclick="toggleSubscribe();">
                  {% if is_subscribed %}Unsubscribe{% else %}Subscribe{% endif %}
                </button>
              {% else %}
                <p>Please <a href="{% url 'login' %}">log in</a> to subscribe or unsubscribe.</p>
              {% endif %}
              </div>
              <div class="col-12 mb-9" style="margin-top: 3rem;">
                {% if user.is_authenticated %}
                <h3 >Add a comment</h3>
                <form method="post" action="{% url 'comment_create' video.id %}">
                  {% csrf_token %}

                  <textarea name="content" cols="40" rows="10" class="form-control bg-primary mb-3" maxlength="500" required="" id="id_content" spellcheck="false"></textarea>
                  <button type="submit" class="btn btn-outline-light">Add Comment</button>
                </form>
              {% else %}
                <p>Please <a href="{% url 'login' %}">log in</a> to add a comment.</p>
              {% endif %}
              </div>
              <div style="margin-top: 3rem;">
                <h2>Comments</h2>
                {% for comment in comments %}
                    <div class="comment mb-3">
                        <strong>{{ comment.user }}</strong>
                        <p>{{ comment.content }}</p>
                    </div>
                {% empty %}
                    <p>No comments yet.</p>
                {% endfor %}
              </div>
            </div>
        </div>
        
    </div>
</div>

    




<div class="like-dislike">
    <!-- Adding like/dislike functionality-->
    <form action="{% url 'like_video' video.id %}" >
      {% csrf_token %}
      <button type="submit" name="like_id" value="{{ video.id }}" class="btn btn-success">Like</button> - {{ total_likes }} Likes
    </form>
   <br>
    <form action="{% url 'dislike_video' video.id %}" >
      {% csrf_token %}
      <button type="submit" name="dislike_id" value="{{ video.id }}" class="btn btn-danger">Dislike</button> - {{ total_dislikes }} Dislikes
    </form>
    
</div>

{% endblock %}
